{
  "_comment": "This file is generated. Please edit .homeycompose/app.json instead.",
  "id": "com.stromer.bike",
  "version": "1.0.0",
  "compatibility": ">=12.0.0",
  "sdk": 3,
  "platforms": [
    "local",
    "cloud"
  ],
  "name": {
    "en": "Stromer"
  },
  "description": {
    "en": "Connect your Stromer e-bike to Homey"
  },
  "category": [
    "energy"
  ],
  "tags": {
    "en": [
      "stromer",
      "e-bike",
      "bicycle",
      "bike",
      "electric bike",
      "battery",
      "tracking"
    ]
  },
  "permissions": [],
  "images": {
    "small": "/assets/images/small.png",
    "large": "/assets/images/large.png",
    "xlarge": "/assets/images/xlarge.png"
  },
  "author": {
    "name": "Stromer Homey Integration",
    "email": "support@stromer-homey.app"
  },
  "support": "https://github.com/stromer-homey/support",
  "homeyCommunityTopicId": 0,
  "source": "https://github.com/stromer-homey/stromer-homey",
  "flow": {
    "triggers": [
      {
        "title": {
          "en": "Battery health drops below"
        },
        "titleFormatted": {
          "en": "Battery health drops below [[threshold]]%"
        },
        "hint": {
          "en": "Triggers when the bike's battery health drops below the specified threshold."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          },
          {
            "type": "range",
            "name": "threshold",
            "min": 0,
            "max": 100,
            "step": 5,
            "label": {
              "en": "Threshold"
            },
            "labelMultiplier": 1,
            "labelDecimals": 0
          }
        ],
        "id": "battery_health_low"
      },
      {
        "title": {
          "en": "Battery level drops below"
        },
        "titleFormatted": {
          "en": "Battery level drops below [[threshold]]%"
        },
        "hint": {
          "en": "Triggers when the bike's battery level drops below the specified threshold."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          },
          {
            "type": "range",
            "name": "threshold",
            "min": 0,
            "max": 100,
            "step": 5,
            "label": {
              "en": "Threshold"
            },
            "labelMultiplier": 1,
            "labelDecimals": 0
          }
        ],
        "id": "battery_low"
      },
      {
        "title": {
          "en": "Bike was unlocked"
        },
        "hint": {
          "en": "Triggers when the bike is unlocked."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          }
        ],
        "id": "bike_unlocked"
      },
      {
        "title": {
          "en": "Theft alarm activated"
        },
        "hint": {
          "en": "Triggers when the bike's theft alarm is activated."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          }
        ],
        "id": "theft_activated"
      },
      {
        "title": {
          "en": "Trip distance exceeds"
        },
        "titleFormatted": {
          "en": "Trip distance exceeds [[distance]] km"
        },
        "hint": {
          "en": "Triggers when the trip distance exceeds the specified value."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          },
          {
            "type": "number",
            "name": "distance",
            "min": 0,
            "max": 1000,
            "step": 1,
            "placeholder": {
              "en": "Distance in km"
            }
          }
        ],
        "id": "trip_distance_exceeds"
      },
      {
        "title": {
          "en": "Trip average speed exceeds"
        },
        "titleFormatted": {
          "en": "Trip average speed exceeds [[speed]] km/h"
        },
        "hint": {
          "en": "Triggers when the trip average speed exceeds the specified value."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          },
          {
            "type": "number",
            "name": "speed",
            "min": 0,
            "max": 50,
            "step": 1,
            "placeholder": {
              "en": "Speed in km/h"
            }
          }
        ],
        "id": "trip_speed_exceeds"
      }
    ],
    "conditions": [
      {
        "title": {
          "en": "Battery level !{{is|is not}} above"
        },
        "titleFormatted": {
          "en": "Battery level !{{is|is not}} above [[threshold]]%"
        },
        "hint": {
          "en": "Check if the bike's battery level is above the specified threshold."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          },
          {
            "type": "range",
            "name": "threshold",
            "min": 0,
            "max": 100,
            "step": 5,
            "label": {
              "en": "Threshold"
            },
            "labelMultiplier": 1,
            "labelDecimals": 0
          }
        ],
        "id": "battery_above"
      },
      {
        "title": {
          "en": "Battery health !{{is|is not}} above"
        },
        "titleFormatted": {
          "en": "Battery health !{{is|is not}} above [[threshold]]%"
        },
        "hint": {
          "en": "Check if the bike's battery health is above the specified threshold."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          },
          {
            "type": "range",
            "name": "threshold",
            "min": 0,
            "max": 100,
            "step": 5,
            "label": {
              "en": "Threshold"
            },
            "labelMultiplier": 1,
            "labelDecimals": 0
          }
        ],
        "id": "battery_health_above"
      },
      {
        "title": {
          "en": "Bike !{{is|is not}} locked"
        },
        "hint": {
          "en": "Check if the bike is currently locked."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          }
        ],
        "id": "is_locked"
      },
      {
        "title": {
          "en": "Light !{{is|is not}} on"
        },
        "hint": {
          "en": "Check if the bike's light is currently on."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          }
        ],
        "id": "light_on"
      },
      {
        "title": {
          "en": "Temperature !{{is|is not}} in range"
        },
        "titleFormatted": {
          "en": "[[sensor]] temperature !{{is|is not}} between [[min]]째C and [[max]]째C"
        },
        "hint": {
          "en": "Check if motor or battery temperature is within the specified range."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          },
          {
            "type": "dropdown",
            "name": "sensor",
            "values": [
              {
                "id": "motor",
                "label": {
                  "en": "Motor"
                }
              },
              {
                "id": "battery",
                "label": {
                  "en": "Battery"
                }
              }
            ]
          },
          {
            "type": "number",
            "name": "min",
            "min": -20,
            "max": 100,
            "placeholder": {
              "en": "Minimum temperature"
            }
          },
          {
            "type": "number",
            "name": "max",
            "min": -20,
            "max": 100,
            "placeholder": {
              "en": "Maximum temperature"
            }
          }
        ],
        "id": "temp_in_range"
      },
      {
        "title": {
          "en": "Theft alarm !{{is|is not}} active"
        },
        "hint": {
          "en": "Check if the bike's theft alarm is currently active."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          }
        ],
        "id": "theft_active"
      }
    ],
    "actions": [
      {
        "title": {
          "en": "Lock bike"
        },
        "hint": {
          "en": "Lock the bike remotely."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          }
        ],
        "id": "lock_bike"
      },
      {
        "title": {
          "en": "Reset trip distance"
        },
        "hint": {
          "en": "Reset the trip distance counter to zero."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          }
        ],
        "id": "reset_trip_distance"
      },
      {
        "title": {
          "en": "Send bike status notification"
        },
        "hint": {
          "en": "Send a notification with the current bike status (battery, trip distance, etc.)."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          }
        ],
        "id": "send_bike_notification"
      },
      {
        "title": {
          "en": "Set light mode"
        },
        "titleFormatted": {
          "en": "Set light to [[light_mode]]"
        },
        "hint": {
          "en": "Control the bike's light."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          },
          {
            "type": "dropdown",
            "name": "light_mode",
            "values": [
              {
                "id": "off",
                "label": {
                  "en": "Off"
                }
              },
              {
                "id": "on",
                "label": {
                  "en": "On"
                }
              },
              {
                "id": "dim",
                "label": {
                  "en": "Dim"
                }
              },
              {
                "id": "bright",
                "label": {
                  "en": "Bright"
                }
              }
            ]
          }
        ],
        "id": "toggle_light"
      },
      {
        "title": {
          "en": "Unlock bike"
        },
        "hint": {
          "en": "Unlock the bike remotely."
        },
        "args": [
          {
            "type": "device",
            "name": "device",
            "filter": "driver_id=stromer-bike"
          }
        ],
        "id": "unlock_bike"
      }
    ]
  },
  "drivers": [
    {
      "name": {
        "en": "Stromer Bike"
      },
      "class": "other",
      "energy": {
        "batteries": [
          "INTERNAL"
        ]
      },
      "capabilities": [
        "measure_battery",
        "stromer_battery_health",
        "alarm_theft",
        "stromer_motor_temp_c",
        "stromer_battery_temp_c",
        "stromer_trip_distance",
        "stromer_average_speed_trip",
        "stromer_distance_total",
        "stromer_distance_avg_speed",
        "stromer_year_distance",
        "stromer_year_avg_speed",
        "stromer_month_distance",
        "stromer_month_avg_speed",
        "stromer_day_avg_speed",
        "stromer_avg_energy",
        "stromer_total_distance",
        "stromer_lifetime_total_km",
        "stromer_user_total_distance",
        "stromer_power_cycles",
        "stromer_atmospheric_pressure",
        "stromer_total_energy_consumption",
        "stromer_latitude",
        "stromer_longitude",
        "stromer_assistance_level",
        "onoff",
        "locked"
      ],
      "capabilitiesOptions": {
        "onoff": {
          "title": {
            "en": "Light"
          }
        },
        "locked": {
          "title": {
            "en": "Lock"
          }
        }
      },
      "images": {
        "small": "/drivers/stromer-bike/assets/images/small.png",
        "large": "/drivers/stromer-bike/assets/images/large.png",
        "xlarge": "/drivers/stromer-bike/assets/images/xlarge.png"
      },
      "pair": [
        {
          "id": "list_devices",
          "template": "list_devices",
          "navigation": {
            "next": "add_devices"
          }
        },
        {
          "id": "add_devices",
          "template": "add_devices"
        }
      ],
      "repair": [
        {
          "id": "list_devices",
          "template": "list_devices"
        }
      ],
      "settings": [
        {
          "type": "group",
          "label": {
            "en": "Polling Settings"
          },
          "children": [
            {
              "id": "poll_interval",
              "type": "number",
              "label": {
                "en": "Default Polling Interval (minutes)"
              },
              "value": 10,
              "min": 1,
              "max": 60,
              "hint": {
                "en": "How often to check bike status when inactive (1-60 minutes)"
              }
            },
            {
              "id": "active_poll_interval",
              "type": "number",
              "label": {
                "en": "Active Polling Interval (seconds)"
              },
              "value": 30,
              "min": 10,
              "max": 300,
              "hint": {
                "en": "How often to check bike status when active/unlocked (10-300 seconds)"
              }
            }
          ]
        },
        {
          "type": "group",
          "label": {
            "en": "Bike Information"
          },
          "children": [
            {
              "id": "bike_id",
              "type": "label",
              "label": {
                "en": "Bike ID"
              },
              "value": "-"
            },
            {
              "id": "bike_nickname",
              "type": "label",
              "label": {
                "en": "Bike Name"
              },
              "value": "-"
            }
          ]
        }
      ],
      "id": "stromer-bike"
    }
  ],
  "capabilities": {
    "alarm_theft": {
      "type": "boolean",
      "title": {
        "en": "Theft Alarm",
        "nl": "Diefstal Alarm"
      },
      "desc": {
        "en": "Indicates whether the bike's theft alarm is active",
        "nl": "Geeft aan of het fiets diefstal alarm actief is"
      },
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "insights": true,
      "insightsTitleTrue": {
        "en": "Theft alarm activated",
        "nl": "Diefstal alarm geactiveerd"
      },
      "insightsTitleFalse": {
        "en": "Theft alarm deactivated",
        "nl": "Diefstal alarm gedeactiveerd"
      }
    },
    "stromer_assistance_level": {
      "type": "number",
      "title": {
        "en": "Assistance Level"
      },
      "decimals": 0,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "min": 0,
      "max": 3,
      "insights": true,
      "chartType": "stepLine"
    },
    "stromer_atmospheric_pressure": {
      "type": "number",
      "title": {
        "en": "Atmospheric Pressure"
      },
      "units": {
        "en": "hPa"
      },
      "decimals": 1,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "insights": true
    },
    "stromer_average_speed_trip": {
      "type": "number",
      "title": {
        "en": "Average Speed (Trip)"
      },
      "units": {
        "en": "km/h"
      },
      "decimals": 1,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "min": 0,
      "insights": true,
      "chartType": "spline"
    },
    "stromer_avg_energy": {
      "type": "number",
      "title": {
        "en": "Average Energy Consumption"
      },
      "units": {
        "en": "Wh/km"
      },
      "decimals": 1,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "min": 0,
      "insights": true,
      "chartType": "spline"
    },
    "stromer_battery_health": {
      "type": "number",
      "title": {
        "en": "Battery Health"
      },
      "units": {
        "en": "%"
      },
      "decimals": 1,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "min": 0,
      "max": 100,
      "insights": true,
      "chartType": "spline"
    },
    "stromer_battery_temp_c": {
      "type": "number",
      "title": {
        "en": "Battery Temperature"
      },
      "units": {
        "en": "째C"
      },
      "decimals": 1,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "insights": true,
      "chartType": "spline"
    },
    "stromer_day_avg_speed": {
      "type": "number",
      "title": {
        "en": "Day Average Speed"
      },
      "units": {
        "en": "km/h"
      },
      "decimals": 1,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "min": 0,
      "insights": true,
      "chartType": "spline"
    },
    "stromer_distance_avg_speed": {
      "type": "number",
      "title": {
        "en": "Distance Average Speed"
      },
      "units": {
        "en": "km/h"
      },
      "decimals": 1,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "min": 0,
      "insights": true,
      "chartType": "spline"
    },
    "stromer_distance_total": {
      "type": "number",
      "title": {
        "en": "Distance"
      },
      "units": {
        "en": "km"
      },
      "decimals": 2,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "min": 0,
      "insights": true,
      "chartType": "stepLine"
    },
    "stromer_latitude": {
      "type": "number",
      "title": {
        "en": "Latitude"
      },
      "decimals": 6,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "insights": true
    },
    "stromer_lifetime_total_km": {
      "type": "number",
      "title": {
        "en": "Lifetime Total Distance"
      },
      "units": {
        "en": "km"
      },
      "decimals": 2,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "min": 0,
      "insights": true,
      "chartType": "stepLine"
    },
    "stromer_longitude": {
      "type": "number",
      "title": {
        "en": "Longitude"
      },
      "decimals": 6,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "insights": true
    },
    "stromer_month_avg_speed": {
      "type": "number",
      "title": {
        "en": "Month Average Speed"
      },
      "units": {
        "en": "km/h"
      },
      "decimals": 1,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "min": 0,
      "insights": true,
      "chartType": "spline"
    },
    "stromer_month_distance": {
      "type": "number",
      "title": {
        "en": "Month Distance"
      },
      "units": {
        "en": "km"
      },
      "decimals": 2,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "min": 0,
      "insights": true,
      "chartType": "stepLine"
    },
    "stromer_motor_temp_c": {
      "type": "number",
      "title": {
        "en": "Motor Temperature"
      },
      "units": {
        "en": "째C"
      },
      "decimals": 1,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "insights": true,
      "chartType": "spline"
    },
    "stromer_power_cycles": {
      "type": "number",
      "title": {
        "en": "Power Cycles"
      },
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "insights": true
    },
    "stromer_total_distance": {
      "type": "number",
      "title": {
        "en": "Total Distance"
      },
      "units": {
        "en": "km"
      },
      "decimals": 2,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "min": 0,
      "insights": true,
      "chartType": "stepLine"
    },
    "stromer_total_energy_consumption": {
      "type": "number",
      "title": {
        "en": "Total Energy Consumption"
      },
      "units": {
        "en": "Wh"
      },
      "decimals": 0,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "insights": true
    },
    "stromer_trip_distance": {
      "type": "number",
      "title": {
        "en": "Trip Distance"
      },
      "units": {
        "en": "km"
      },
      "decimals": 2,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "min": 0,
      "insights": true,
      "chartType": "stepLine"
    },
    "stromer_user_total_distance": {
      "type": "number",
      "title": {
        "en": "User Total Distance"
      },
      "units": {
        "en": "km"
      },
      "decimals": 1,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "insights": true
    },
    "stromer_year_avg_speed": {
      "type": "number",
      "title": {
        "en": "Year Average Speed"
      },
      "units": {
        "en": "km/h"
      },
      "decimals": 1,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "min": 0,
      "insights": true,
      "chartType": "spline"
    },
    "stromer_year_distance": {
      "type": "number",
      "title": {
        "en": "Year Distance"
      },
      "units": {
        "en": "km"
      },
      "decimals": 2,
      "getable": true,
      "setable": false,
      "uiComponent": "sensor",
      "min": 0,
      "insights": true,
      "chartType": "stepLine"
    }
  }
}